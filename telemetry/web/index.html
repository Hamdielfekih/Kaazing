<!DOCTYPE html>
<html>
<head>

<title>Black Box</title>

<!-- Styles -->
<!-- Mostly inline SVG -->
<style type="text/css">
body {
    margin: 0px;
    padding: 0px;
}

.airspeed {
    height: 75%;
    position: absolute;
    left: 20px;
    top: 20px;
    width: 86px;
}

.altimeter {
    height: 75%;
    position: absolute;
    right: 20px;
    top: 20px;
    width: 68px;
}

.map {
    bottom: 0px;
    left: 0px;
    position: absolute;
    right: 0px;
    top: 0px;
}
</style>

<!-- Animation -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.11.5/TweenLite.min.js" type="text/javascript"></script>

<!-- Map -->
<script src="https://maps.googleapis.com/maps/api/js?sensor=false" type="text/javascript"></script>

<!-- Gauges -->
<script src="Airspeed.js" type="text/javascript"></script>
<script src="Altimeter.js" type="text/javascript"></script>

<!-- Application -->
<script type="text/javascript">
// Constants
var KAAZING_LATITUDE = 37.4173652;
var KAAZING_LONGITUDE = -121.9788182;

// Global
var airspeed = null;
var altimeter = null;
var interval = null;
var map = null;

// Update the situational display
function updateSituation( values )
{
    var newAirspeed = Math.random() * 35;
    var newAltitude = Math.round( Math.random() * 3000 );

    airspeed.setAirspeed( newAirspeed );
    altimeter.setAltitude( newAltitude );
}

// Setup map
function doMapLoad()
{
    var options = null;

    // Center on Kaazing HQ
    // Hide most default UI
    // Disable dragging
    options = {
        center: new google.maps.LatLng( KAAZING_LATITUDE, KAAZING_LONGITUDE ),
        zoom: 14,
        disableDefaultUI: true,
        draggable: false,
        scaleControl: true,
        zoomControl: true,
        zoomControlOptions: {
            position: google.maps.ControlPosition.RIGHT_TOP,
            style: google.maps.ZoomControlStyle.LARGE
        }
    };

    // Create map instance
    map = new google.maps.Map( document.querySelector( ".map" ), options );
}

// Called when the window loads
// Initializes DOM references
function doWindowLoad()
{
    // Airspeed
    airspeed = new Airspeed( ".airspeed" );
    // airspeed.setAirspeed( 24 );

    // Altimeter
    altimeter = new Altimeter( ".altimeter" );
    // altimeter.setAltitude( 1234 );

    // Fit to window
    doWindowResize();

    // Pretend values for testing
    interval = setInterval( updateSituation, 2000 );
}

// Called to layout user interface
function doWindowResize()
{
    airspeed.container.style.top = Math.round( ( window.innerHeight - airspeed.container.clientHeight ) / 2 ) + "px";
    altimeter.container.style.top = Math.round( ( window.innerHeight - altimeter.container.clientHeight ) / 2 ) + "px";
}

// Setup page load
window.addEventListener( "load", doWindowLoad );
window.addEventListener( "resize", doWindowResize );

// Setup map library load
google.maps.event.addDomListener( window, "load", doMapLoad );
</script>

</head>
<body>

<!-- Map -->
<div class="map"></div>

<!-- Airspeed -->
<div class="airspeed"></div>

<!-- Altimeter -->
<div class="altimeter"></div>

</body>
</html>